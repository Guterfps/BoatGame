(()=>{"use strict";var t,e,i=function(){function t(){this.canvas=document.getElementById("BoatGame"),this.canvas?this.context=this.canvas.getContext("2d"):console.log("canvas is null")}return t.prototype.RenderRect=function(t,e,i,n,o){this.context&&(this.context.beginPath(),this.context.fillStyle=o,this.context.fillRect(t,e,i,n),this.context.closePath())},t.prototype.Clear=function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.GetWidth=function(){return this.canvas.width},t.prototype.GetHeight=function(){return this.canvas.height},t}(),n=function(){function t(t){this.score=0,this.life_points=3,this.position={x:0,y:0},this.width=100,this.hieght=50,this.position=t}return t.prototype.GetScore=function(){return this.score},t.prototype.SetScore=function(t){this.score=t},t.prototype.GetLifePoints=function(){return this.life_points},t.prototype.SetLifePoints=function(t){this.life_points=t},t.prototype.GetPosition=function(){return this.position},t.prototype.SetPosition=function(t){this.position=t},t.prototype.GetShape=function(){return{pos:this.position,w:this.width,h:this.hieght}},t}(),o=function(){function t(t){this.ui_font="24px Arial",this.ui_fillStyle="#0095DD",this.image=new Image,this.renderer=t,this.image.src="../../../assets/images/boat.png"}return t.prototype.DrawPlayer=function(t){var e=t.pos,i=t.w,n=t.h,o=e.x,s=e.y;this.renderer.context.drawImage(this.image,o,s,i,n)},t.prototype.DrawScore=function(t){var e=this.renderer.context;e.font=this.ui_font,e.fillStyle=this.ui_fillStyle,e.fillText("Score: ".concat(t),10,20)},t.prototype.DrawLifePoints=function(t){var e=this.renderer.context;e.font=this.ui_font,e.fillStyle=this.ui_fillStyle,e.fillText("Lives: ".concat(t),10,40)},t.prototype.SetRenderer=function(t){this.renderer=t},t.prototype.GetRenderer=function(){return this.renderer},t}(),s=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e};!function(t){t[t.RUN=0]="RUN",t[t.PUSE=1]="PUSE",t[t.GAME_OVER=2]="GAME_OVER",t[t.EXIT=3]="EXIT"}(t||(t={})),function(t){t[t.LEFT=-1]="LEFT",t[t.RIGHT=1]="RIGHT",t[t.UP=-1]="UP",t[t.DOWN=1]="DOWN",t[t.NONE=0]="NONE"}(e||(e={}));var r,h=function(){function t(t,i){var n=this;this.move_direction=e.NONE,this.move_speed=10,this.dx=0,this.HandleKeyDown=function(t){switch(t.code){case"ArrowRight":n.move_direction=e.RIGHT;break;case"ArrowLeft":n.move_direction=e.LEFT;break;default:n.move_direction=e.NONE}},this.HandleKeyUp=function(t){switch(t.code){case"ArrowRight":case"ArrowLeft":n.move_direction=e.NONE}},this.HandleMouseMove=function(t){var e=n.display.GetRenderer().canvas,i=t.clientX-e.offsetLeft,o=n.player.GetShape().w/2,s=n.player.GetPosition();i-o>0&&i+o<e.width&&(s.x=i-o),n.player.SetPosition(s)},this.player=t,this.display=i,document.addEventListener("keydown",this.HandleKeyDown,!1),document.addEventListener("keyup",this.HandleKeyUp,!1),document.addEventListener("mousemove",this.HandleMouseMove,!1)}return t.prototype.TakeInput=function(){this.dx=this.move_direction*this.move_speed},t.prototype.Update=function(t){if(this.player.GetLifePoints()>0){var e=this.player.GetPosition();this.display.GetRenderer().GetWidth()>=e.x+this.dx+this.player.GetShape().w&&e.x+this.dx>=0&&(e.x+=this.dx),this.player.SetPosition(e)}else t.EventNotify("player loss",this.player.GetScore())},t.prototype.Draw=function(){this.display.DrawPlayer(this.player.GetShape()),this.display.DrawLifePoints(this.player.GetLifePoints()),this.display.DrawScore(this.player.GetScore())},t.prototype.GetPlayerShape=function(){return this.player.GetShape()},t.prototype.IncreseScore=function(t){this.player.SetScore(this.player.GetScore()+t)},t.prototype.ChangeLifePoints=function(t){this.player.SetLifePoints(this.player.GetLifePoints()+t)},t}(),a=function(){function t(t){this.width=120,this.hieght=80,this.position=t}return t.prototype.GetPosition=function(){return this.position},t.prototype.SetPosition=function(t){this.position=t},t.prototype.GetShape=function(){return{pos:this.position,w:this.width,h:this.hieght}},t}(),p=function(){function t(t){this.image=new Image,this.renderer=t,this.image.src="../../../assets/images/plane.png"}return t.prototype.DrawPlane=function(t){var e=t.pos,i=t.w,n=t.h,o=e.x,s=e.y;this.renderer.context.drawImage(this.image,o,s,i,n)},t.prototype.SetRenderer=function(t){this.renderer=t},t.prototype.GetRenderer=function(){return this.renderer},t}(),c=function(){function t(t,i){this.direction=e.LEFT,this.speed=2,this.dx=0,this.plane=t,this.display=i}return t.prototype.TakeInput=function(){this.dx=this.direction*this.speed},t.prototype.Update=function(t){var e=this.plane.GetPosition();e.x+this.dx>0?e.x+=this.dx:e.x+=this.display.GetRenderer().GetWidth(),this.plane.SetPosition(e),this.SpawnParachute(t)},t.prototype.Draw=function(){this.display.DrawPlane(this.plane.GetShape())},t.prototype.SpawnParachute=function(t){Math.random()>.99&&t.EventNotify("spawn parachute",this.plane.GetPosition())},t}(),d=function(){function t(t){this.width=40,this.hiegth=60,this.position=t}return t.prototype.GetPosition=function(){return this.position},t.prototype.SetPosition=function(t){this.position=t},t.prototype.GetShape=function(){return{pos:this.position,w:this.width,h:this.hiegth}},t}(),u=function(){function t(t){this.image=new Image,this.renderer=t,this.image.src="../../../assets/images/parachutist.png"}return t.prototype.DrawParachute=function(t){var e=t.pos,i=t.w,n=t.h,o=e.x,s=e.y;this.renderer.context.drawImage(this.image,o,s,i,n)},t.prototype.SetRenderer=function(t){this.renderer=t},t.prototype.GetRenderer=function(){return this.renderer},t}(),f=function(){function t(t,i,n){this.direction=e.DOWN,this.speed=1,this.dy=0,this.Parachute=t,this.display=i,this.boat_detector=n}return t.prototype.TakeInput=function(){this.dy=this.direction*this.speed},t.prototype.Update=function(t){var e=this.Parachute.GetPosition();e.y<this.display.GetRenderer().GetHeight()?(e.y+=this.dy,this.Parachute.SetPosition(e)):t.EventNotify("parachute died",this),this.boat_detector.IsColliding(this.Parachute.GetShape())&&t.EventNotify("boat collision",this)},t.prototype.Draw=function(){this.display.DrawParachute(this.Parachute.GetShape())},t}(),y=function(){function t(){this.map=new Map}return t.prototype.AddEventNotify=function(t,e){this.map.has(t)||this.map.set(t,new Set),this.map.get(t).add(e)},t.prototype.RemoveEvent=function(t){this.map.delete(t)},t.prototype.RemoveNotify=function(t,e){var i;null===(i=this.map.get(t))||void 0===i||i.delete(e)},t.prototype.EventNotify=function(t,e){var i;null===(i=this.map.get(t))||void 0===i||i.forEach((function(t){t(e)}))},t.prototype.Clear=function(){this.map.clear()},t}(),l=function(){function t(t){this.rect=t}return t.prototype.IsColliding=function(t){return t.pos.x<this.rect.pos.x+this.rect.w&&t.pos.x+t.w>this.rect.pos.x&&t.pos.y<this.rect.pos.y+this.rect.h&&t.pos.y+t.h>this.rect.pos.y},t}();(r=new(function(){function e(){var e=this;this.state=t.PUSE,this.renderer=new i,this.actors=new Array,this.events=new y,this.final_score=0,this.background_image=new Image,this.sea_image=new Image,this.sea_lvl=200,this.ResetGame=function(){e.actors=new Array,e.events.Clear(),e.final_score=0,e.Init(),document.removeEventListener("click",e.ResetGame)},this.Run=this.Run.bind(this),this.background_image.src="../../../assets/images/background.png",this.sea_image.src="../../../assets/images/sea.png"}return e.prototype.AddActor=function(t){this.actors.push(t)},e.prototype.RemoveActor=function(t){var e=this.actors.indexOf(t);-1!=e&&this.actors.splice(e,1)},e.prototype.Init=function(){var e=this;this.state=t.RUN;var i=new h(new n(new s(this.renderer.GetWidth()/2,.65*this.renderer.GetHeight())),new o(this.renderer));this.AddActor(i),this.AddActor(new c(new a(new s(this.renderer.GetWidth(),50)),new p(this.renderer))),this.events.AddEventNotify("spawn parachute",(function(t){e.AddActor(new f(new d(new s(t.x,t.y)),new u(e.renderer),new l(i.GetPlayerShape())))})),this.events.AddEventNotify("parachute died",(function(t){i.ChangeLifePoints(-1),e.RemoveActor(t)})),this.events.AddEventNotify("boat collision",(function(t){i.IncreseScore(1),e.RemoveActor(t)})),this.events.AddEventNotify("player loss",(function(i){e.state=t.GAME_OVER,e.final_score=i}))},e.prototype.Run=function(){if(this.state!==t.EXIT){switch(this.state){case t.RUN:this.HandleInput(),this.UpdateGame(),this.renderer.Clear(),this.Display();break;case t.GAME_OVER:this.DisplayGameOver(),document.addEventListener("click",this.ResetGame)}requestAnimationFrame(this.Run)}},e.prototype.GetState=function(){return this.state},e.prototype.ChangeState=function(t){this.state=t},e.prototype.HandleInput=function(){this.actors.forEach((function(t){t.TakeInput()}))},e.prototype.UpdateGame=function(){var t=this;this.actors.forEach((function(e){e.Update(t.events)}))},e.prototype.Display=function(){var t=this.renderer.GetWidth(),e=this.renderer.GetHeight();this.renderer.context.drawImage(this.background_image,0,0,t,e),this.renderer.context.drawImage(this.sea_image,0,e-this.sea_lvl,t,this.sea_lvl),this.actors.forEach((function(t){t.Draw()}))},e.prototype.DisplayGameOver=function(){var t=this.renderer.context;t.font="32px Arial",t.fillStyle="#0095DD",t.fillText("Game Over Final Score: ".concat(this.final_score),this.renderer.GetWidth()/2-200,this.renderer.GetHeight()/2-50),t.fillText("Click to restart",this.renderer.GetWidth()/2-100,this.renderer.GetHeight()/2)},e}())).Init(),r.Run()})();
//# sourceMappingURL=bundle.js.map